---
description: Test assertion and error handling rules
globs: ["**/*.test.js", "**/test/**/*.js", "**/specs/**/*.js"]
alwaysApply: true
---

# Test Assertions & Error Handling

## Assertion Priority

- **Status Code First**: Always assert status code before other properties
- **Property Validation**: Use `toHaveProperty()` for checking response structure
- **Type Validation**: Use `expect.any(String)` for dynamic values like IDs
- **Async/Await**: Use async/await for all API calls

## Error Case Verification

- **Exact Error Matching**: For error cases, use `toEqual()` with exact expected structure
- **Error Structure**: Expect the standard validation error format with key, errorType, and message
- **Exact Return Body**: For error case tests, verify the exact return body structure